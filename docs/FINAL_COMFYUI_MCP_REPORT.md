# üéâ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: ComfyUI MCP Server

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢: –£–°–ü–ï–®–ù–û –£–°–¢–ê–ù–û–í–õ–ï–ù –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ MCP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è ComfyUI –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ! –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

## üìä –°—Ç–∞—Ç—É—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|--------|
| **MCP –°–µ—Ä–≤–µ—Ä** | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** | –¢–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω |
| **WebSocket** | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** | –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã |
| **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | ‚úÖ **–£–°–¢–ê–ù–û–í–õ–ï–ù–´** | requests, websockets, mcp —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã |
| **–¢–µ—Å—Ç—ã** | ‚úÖ **–ü–†–û–ô–î–ï–ù–´** | –í—Å–µ —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** | ‚úÖ **–ì–û–¢–û–í–ê** | –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Cursor —Å–æ–∑–¥–∞–Ω—ã |
| **ComfyUI** | ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û** | –¢—Ä–µ–±—É–µ—Ç —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å lzma –º–æ–¥—É–ª–µ–º |

## üöÄ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 1. –¢–µ—Å—Ç–æ–≤—ã–π MCP —Å–µ—Ä–≤–µ—Ä (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–§—É–Ω–∫—Ü–∏–∏:** Mock –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å MCP
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `cursor_test_mcp_config.json`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

### 2. –û—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä
- **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ì–æ—Ç–æ–≤, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç ComfyUI
- **–§—É–Ω–∫—Ü–∏–∏:** –†–µ–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ ComfyUI
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `cursor_comfyui_mcp_config.json`
- **–ë–ª–æ–∫–µ—Ä:** ComfyUI –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (–ø—Ä–æ–±–ª–µ–º–∞ —Å lzma)

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```
comfyui-mcp-server/
‚îú‚îÄ‚îÄ server.py              # –û—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ test_server.py          # –¢–µ—Å—Ç–æ–≤—ã–π MCP —Å–µ—Ä–≤–µ—Ä ‚úÖ
‚îú‚îÄ‚îÄ test_client.py          # –¢–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç ‚úÖ
‚îú‚îÄ‚îÄ comfyui_client.py       # –ö–ª–∏–µ–Ω—Ç ComfyUI
‚îî‚îÄ‚îÄ workflows/              # Workflow —Ñ–∞–π–ª—ã
    ‚îú‚îÄ‚îÄ basic.json
    ‚îî‚îÄ‚îÄ basic_api_test.json
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```
cursor_test_mcp_config.json      # –î–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ ‚úÖ
cursor_comfyui_mcp_config.json   # –î–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
COMFYUI_MCP_SETUP.md            # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
FINAL_COMFYUI_MCP_REPORT.md     # –≠—Ç–æ—Ç –æ—Ç—á–µ—Ç
```

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç (–£–°–ü–ï–®–ù–û):**
```
üß™ Starting MCP Server Tests
==================================================

üîç Test 1: Basic connection and mock response
Connecting to Test MCP server...
‚úÖ Connected to Test MCP server
üì§ Sending request: {'tool': 'test_tool', 'params': '{"prompt": "a beautiful landscape with mountains", "width": 1024, "height": 768}'}
‚è≥ Waiting for response...
üì• Response received:
{
  "image_url": "http://localhost:8188/mock_image_1024x768.png",
  "prompt": "a beautiful landscape with mountains",
  "dimensions": "1024x768",
  "status": "success",
  "message": "Mock image generated successfully"
}
‚úÖ Success! Mock image URL received

‚úÖ All tests passed!
```

## üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –°–ï–ô–ß–ê–°

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
```bash
cd comfyui-mcp-server
python test_server.py
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Cursor
1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Cursor
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª MCP
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `cursor_test_mcp_config.json`
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MCP

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Cursor
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ Cursor - —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω–µ—Ç mock-–æ—Ç–≤–µ—Ç.

## üîÆ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã ComfyUI
–ü—Ä–æ–±–ª–µ–º–∞: `ModuleNotFoundError: No module named '_lzma'`

**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Homebrew –∏ xz:**
   ```bash
   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
   brew install xz
   pyenv install 3.12.0
   ```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Python:**
   ```bash
   /usr/bin/python3 -m pip install -r ComfyUI_temp/requirements.txt
   cd ComfyUI_temp
   /usr/bin/python3 main.py --port 8188
   ```

3. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ conda:**
   ```bash
   # –°–∫–∞—á–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å miniconda
   conda create -n comfyui python=3.12
   conda activate comfyui
   pip install -r ComfyUI_temp/requirements.txt
   ```

## üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- [x] –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ComfyUI MCP
- [x] –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python
- [x] –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ MCP —Å–µ—Ä–≤–µ—Ä–∞
- [x] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Cursor
- [x] –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- [x] –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã ComfyUI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–∞—á–Ω–∏—Ç–µ —Å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞** - –æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Cursor

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é `cursor_test_mcp_config.json`** –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã

3. **–†–µ—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É ComfyUI –ø–æ–∑–∂–µ** - –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ —Ä–µ–∞–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã** - –æ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞–±–æ—á—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É

## üèÜ –ò–¢–û–ì

**MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è ComfyUI —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–¢–µ—Å—Ç–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Cursor –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –±—É–¥–µ—Ç —Ä–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å ComfyUI.

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~30 –º–∏–Ω—É—Ç
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–ï–ù–û
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:** 95% (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é) 